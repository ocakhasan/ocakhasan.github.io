<!doctype html><html lang=tr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Evrişimsel Sinir Ağları (Convolutional Neural Network) Nedir - Hasan Ocak Tech Blog</title><meta name=Description content="Çeşitli konulardan bahseden bir tech blog"><meta property="og:title" content="Evrişimsel Sinir Ağları  (Convolutional Neural Network) Nedir"><meta property="og:description" content="Derin Öğrenmede resimler üzerinde kullanılan evrişimsel sinir ağlarını kullanıyoruz."><meta property="og:type" content="article"><meta property="og:url" content="https://ocakhasan.github.io/evrisimsel-sinir-aglari-nedir/"><meta property="og:image" content="https://ocakhasan.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-12-17T00:00:00+00:00"><meta property="article:modified_time" content="2022-12-07T21:09:02+03:00"><meta property="og:site_name" content="Hasan Ocak Tech Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://ocakhasan.github.io/logo.png"><meta name=twitter:title content="Evrişimsel Sinir Ağları  (Convolutional Neural Network) Nedir"><meta name=twitter:description content="Derin Öğrenmede resimler üzerinde kullanılan evrişimsel sinir ağlarını kullanıyoruz."><meta name=application-name content="Hasan Ocak Tech Blog"><meta name=apple-mobile-web-app-title content="Hasan Ocak Tech Blog"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://ocakhasan.github.io/evrisimsel-sinir-aglari-nedir/><link rel=prev href=https://ocakhasan.github.io/word2vec-nedir-ve-word2veckelimelerden-nasil-ogrenir/><link rel=next href=https://ocakhasan.github.io/pytorch-autograd-nedir-ve-nasil-calisir/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><meta name=google-site-verification content="6FsPs8qV_9zEnPMWf3bEQwRJFU2Q9imUdyZqX_99So4"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Evrişimsel Sinir Ağları  (Convolutional Neural Network) Nedir","inLanguage":"tr","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/ocakhasan.github.io\/evrisimsel-sinir-aglari-nedir\/"},"genre":"posts","keywords":"numpy, pytorch, cnn","wordcount":1500,"url":"https:\/\/ocakhasan.github.io\/evrisimsel-sinir-aglari-nedir\/","datePublished":"2020-12-17T00:00:00+00:00","dateModified":"2022-12-07T21:09:02+03:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Hasan Ocak"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Hasan Ocak Tech Blog">Hasan Ocak</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Hasan Ocak Tech Blog">Hasan Ocak</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Evrişimsel Sinir Ağları (Convolutional Neural Network) Nedir</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Hasan Ocak</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2020-12-17>2020-12-17</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1500 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;8 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept=true><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#tanim>TANIM</a></li><li><a href=#yapisal-gözlem>YAPISAL GÖZLEM</a></li><li><a href=#peki-bu-convolutional-sinir-ağlari-nasil-oluşturuluyor>PEKI BU CONVOLUTIONAL SINIR AĞLARI NASIL OLUŞTURULUYOR?</a><ul><li><ul><li><a href=#convolutional-katman>CONVOLUTIONAL KATMAN</a></li></ul></li><li><a href=#python-ile-ufak-bir-gösterim>PYTHON İLE UFAK BİR GÖSTERİM</a></li></ul></li><li><a href=#pooling-layer>POOLING LAYER</a><ul><li><a href=#pooling-layer-python-ile-implementasyonu>Pooling Layer Python İle İmplementasyonu</a></li></ul></li><li><a href=#references>REFERENCES</a></li></ul></nav></div></div><div class=content id=content><p>Yazıya başlamadan önce belirmek isterim ki, bu tarz derin öğrenme terimlerinin İngilizce ile kullanılması taraftarıyım. Teknik terimlerin Türkçe karşılıkları genelde her zaman duymadığımız kelimeler oluyor ve internette Türkçe pek kaynak yok. Ondan dolayı ben bu terimlerin İngilizce öğrenilip, İngilizce kullanılması taraftarıyım. Herkes global olmaya çalışırken, bizim öyle davranmamamız için hiçbir sebep yok.</p><h2 id=tanim>TANIM</h2><p>Convolutional sinir ağları genel olarak sıradan sinir ağlarına çok benzerdir. Bu sinir ağları da öğrenebilir ağırlık (weight) ve önyargısı (bias) olan sinirlerden (neuron) oluşur. Her bir nöron bazı inputlar alır, dot product uygular ve bu işlemi lineer olmayan bir yolla devam ettirir. Bütün network hala tek bir ayırt edilebilir skoru açıklar. Network resim pixellerini alıp, sonda bir tahmin üretir. Networkun sonunda belirli bir kayıp fonksiyonu (loss function) bulunur.</p><p>Peki bu convolutional sinir ağları normal sinir ağlarına bu kadar benziyorsa ne değişiyor? Bu sorunun cevabı ise şu şekildedir:</p><p>Convolutional sinir ağları inputun resimlerden oluştuğunu varsayar, bu varsayım bize bazı özellikleri sisteme entegre etmemize yardımcı olur.</p><h2 id=yapisal-gözlem>YAPISAL GÖZLEM</h2><p><strong>Normal Sinir Ağları:</strong> Normal sinir ağları tek bir input alır, onu bazı gizli katmanlardan (hidden layer) geçirir. Her bir hidden layer nöron kümelerinden oluşur, her bir nöron, bir önceki katmandaki bütün nöronlarla bağlantılıdır ve diğer nöronlardan bağımsız şekilde çalışır. Son katman ise sonuç katmanı (output layer) olarak adlandırılır ve bu katmanda her bir sınıfın olasılığı belli olur.</p><p>Bu normal sinir ağları resimler kullanılınca pek iyi ölçeklenemiyor. Örnek olarak $(32, 32, 3)$ lük boyutlarda resimler kullanırsak, ilk katman $32 * 32 * 3 = 3072$ ağırlığa sahip olacaktır. Bu yük halledilebilir şekilde görülüyor ancak, bu fully-connected yapı büyük resimlere ölçeklenmiyor. Örnek olarak eğer biz boyutları $(200, 200, 3)$ olan resimler kullanırsak, bu sefer nilk nöronlar $200 * 200 * 3 = 120, 000$ ağırlığa sahip olacaklar. Ancak bu büyük numaralı ağırlıklar aşırı uyma (<em>overfitting</em>) denilen olaya sebep olacaktır.</p><p>Convolutional sinir ağları ise inputun resimlerden oluşmasınından faydalanır ve buna göre yapıyı daha mantıklı şekilde kurar. Normal sinir ağlarının aksine, Convolutiona sinir ağlarının nöronları 3 boyuta ayarlanmış şekildedir. <strong>genişlik, yükseklik, derinlik</strong>.</p><p>Örnek olarak $(32, 32, 3)$ boyutlu resimlerde</p><ul><li>Genişlik = 32</li><li>Yükseklik = 32</li><li>Derinlik = 3
olacaktır.</li></ul><h2 id=peki-bu-convolutional-sinir-ağlari-nasil-oluşturuluyor>PEKI BU CONVOLUTIONAL SINIR AĞLARI NASIL OLUŞTURULUYOR?</h2><p>Bu sinir ağları katman dizilerinden oluşur ve bu katmanlar ise şu şekildedir.</p><ul><li>Convolutional Katman</li><li>Pooling Katmanı</li><li>Fully-Connected Katmanı</li></ul><p>Bu 3 katmandan oluşan katmanları birleştirip bir sinir ağı oluşturacağız.</p><h4 id=convolutional-katman>CONVOLUTIONAL KATMAN</h4><p>Convolutional katman Convolutional sinir ağlarının büyük ağır işini yapan katmanlardır.</p><p>Conv katmanlar parametreleri öğrenilebilir filtrelerden oluşur. Her bir filtre boyut olarak küçüktür, ancak input derinliği boyunca uzanırlar. Örnek olarak, tipik bir filtre $5 * 5 * 3$ boyutlarında olabilir. İlk 5 genişlik, ikinci 5 yükseklik ve üçüncü 3 ise resimin 3 derinlikli olmasından kaynaklanır. Doğrudan iletme kısmında, her bir filtreyi input resmi üzerinde kaydırıyoruz, bu kaydırma sırasında resimlerde pixeller ile filtredeki sayılar ile dot product alıyoruz. Filtreyi kaydırma işlemi sırasında 2 boyutlu bir aktivite haritası oluşturuyoruz. Bu harita ise bize her bir pozisyondaki cevabı veriyor. Sinir ağı, bu filtreler ne zaman belirli bir görsel özellik, örnek olarak kenar, gördüğü zaman öğrenecek. Her bir filtrenin oluşturduğu haritaları üst üste sıkıştırıp bunu bir sonraki katmana iletiyoruz.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=../../images/cnn.png data-srcset="../../images/cnn.png, ../../images/cnn.png 1.5x, ../../images/cnn.png 2x" data-sizes=auto alt=../../images/cnn.png title="Convolutional Sinir Ağları Örnek"></p><p><strong>BOYUTSAL AYARLAMA</strong></p><p>Her bir nöronun nasıl bağlı olduğunu anlattık ancak output hacminde kaç tane nöron olduğundan bahsetmedik. Output hacmini belirleyen 3 ayrı parametre vardır.</p><ul><li><strong>DERİNLİK:</strong> Bu parametre kaç tane nöron kullandığınıza işaret eder. Örnek olarak ilk convolutional katman input olarak resmi alırken, farklı nöronlar bu resimde farklı detayları fark edebilir.</li><li><strong>STRIDE (KAYDIRMA ADIMI):</strong> Bu parametre ise filtreyi kaç pixel kaydıracağımıza işaret eder. Eğer <code>stride</code> bir ise, filtreleri bir pixel kaydıracağımız anlamına gelir.</li><li><strong>ZERO-PADDING: (SIFIRLARLA DOLDURMA)</strong> Bazı durumlarda inputun etrafını sıfırlarla doldurmak uygun olmaktadır. Bu işlemin güzel bir tarafı ise, bize output boyutunu kontrol altında tutma olanağı vermesidir. Örnek olarak daha yüksek boyutlu outputlar istersek, inputu filtre boyutu kadar sıfırlarla doldurup, bir sonraki katmana aktarılacak outputun boyutunu, şuanki katmandaki input boyutuna eşit tutabiliriz.</li></ul><p>Output hacminin boyutunu şu şekilde hesaplayabiliriz.</p><ul><li>Input Boyutu = $W$</li><li>Convolutional katman nöronları filtre boyutu = $F$</li><li>Stride = $S$</li><li>Zero-Padding = $P$</li></ul><p>Output hacmi boyutu formülü = $(W - F + 2P) / S + 1$.</p><p>Örnek olarak eğer elimizde $10 * 10$ boyutlu bir resim varsa ve bizim filtre boyutumuz $3 * 3$, stride = $1$ ve padding = $0$ ise</p><p>$$
Output Boyutu = (10 - 3 + 2*0) / 1 + 1 = 8 * 8
$$</p><p>Şimdi bu boyut tek bir nörondan çıkan sonuç. Eğer elimizde $n$ tane nöron varsa, bu katmandan çıkan sonucun boyutu $8 * 8 * n$ olacaktı.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=../../images/cnn_filter.png data-srcset="../../images/cnn_filter.png, ../../images/cnn_filter.png 1.5x, ../../images/cnn_filter.png 2x" data-sizes=auto alt=../../images/cnn_filter.png title="Convolutional Sinir Ağları Örnek"></p><p>Yukarıdaki örnekten de görüleceği üzere filtre boyutumuz $3 <em>3$, bundan dolayı resimde de (3</em>3) lük alanlar alıp, bu aldığımız alanla filtre arasında bir dot product işlemi uyguluyoruz. Peki resimdeki $31$ sayısına nasıl ulaştık onu inceleyelim.</p><p>$$
(1 * 1) + (0 * 2) + (1 * 3) + (0 * 4) + (1 * 5) + (1 * 6) + (1 * 7) + (0 * 8) + (1 * 9)
$$</p><p>$$
1 + 3 + 5 + 6 + 7 + 9 = 31
$$</p><p>Özetlemek gerekirse</p><ul><li>Conv layer $W_1 * H_1 * D_1$ boyutlarında input alır</li><li>4 parametreye ihtiyaç duyar<ul><li>Filtre sayısı $K$</li><li>Filtrenin boyutları $F$</li><li>Stride $S$</li><li>Zero padding sayısı $P$</li></ul></li><li>$W_2 * H_2 * D_2$ boyutlarında output üretir.<ul><li>$W_2 = (W_1 - F + 2P)/S + 1)$</li><li>$H_2 = (H_1 - F + 2P)/S + 1$</li><li>$D_2 = K$</li></ul></li></ul><h3 id=python-ile-ufak-bir-gösterim>PYTHON İLE UFAK BİR GÖSTERİM</h3><p>Şimdi <code>tensorflow</code> ile basit bir gösterim yapıp bu boyutları daha iyi anlayalım.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>tensorflow</span> <span class=k>as</span> <span class=nn>tf</span>
</span></span><span class=line><span class=cl><span class=c1># The inputs are 28x28 RGB images with `channels_last` and the batch</span>
</span></span><span class=line><span class=cl><span class=c1># size is 4.</span>
</span></span><span class=line><span class=cl><span class=n>input_shape</span> <span class=o>=</span> <span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>28</span><span class=p>,</span> <span class=mi>28</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=n>input_shape</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Conv2D</span><span class=p>(</span>
</span></span><span class=line><span class=cl><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=n>activation</span><span class=o>=</span><span class=s1>&#39;relu&#39;</span><span class=p>,</span> <span class=n>input_shape</span><span class=o>=</span><span class=n>input_shape</span><span class=p>[</span><span class=mi>1</span><span class=p>:])(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>y</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>26</span> <span class=p>,</span> <span class=mi>26</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Burada olan işlemler şu şekildedir</p><ul><li><code>input_shape</code> Conv layer&rsquo;a verilecek olan inputun boyutlarıdır. (4, 28, 28, 3) şu anlama gelmektedir. Bizim elimizde 4 adet resim var, ve bu resimlerin boyutları (28, 28, 3)tür.</li><li><code>Conv2D</code> &rsquo; e verilen parametreler ise şu şekildedir. İlk verilen parametre <code>2</code> kaç adet filtre kullanacağımızı gösterir. İkinci parametre <code>3</code> ise filtre boyutunu vermektedir. Yani filtre boyutumuz $(3, 3)$ olacaktır.</li></ul><p>Şimdi burada oluşan outputun nasıl oluştuğuna bakalım. Yukarıda özetlediğimiz gibi her şeyi tek tek yazalım</p><p>Input boyutları $W_1 * H_1 * D_1$ şeklindeydi. Bundan dolayı</p><ul><li>$W_1 = 28$</li><li>$H_1 = 28$</li><li>$D_1 = 3$</li></ul><p>Daha sonra filtre sayımız $K = 2$, filtre boyutumuz ise $F = 3$, stride ise default olarak $S = 1$dir. Padding ise default olarak $P = 0$dır.</p><p>O zaman şimdi output boyutlarımızı $(W_2 * H_2 * D_2)$ hesaplayabiliriz.</p><ul><li>$W_2 = (28 - 3 + 2 * 0) / 1 + 1 = 25 + 1 = 26$</li><li>$H_2 = (28 - 3 + 2 * 0) / 1 + 1 = 25 + 1 = 26$</li><li>$D_2 = K = 2$</li></ul><p>Her bir resim için oluşturulan output boyutları $(26, 26, 2)$. Elimizde 4 adet resim var ve bundan dolayı çıkan output boyutu $(4, 26, 26, 2)$</p><h2 id=pooling-layer>POOLING LAYER</h2><p>Convolutional sinir ağlarında convolutional katmanlar arasına <em>Pooling</em> katmanları eklemek çok yaygındır. <em>Pooling</em> katmanının görevi verilen inputun boyutlarını kademeleri olarak azaltarak parametrelerin ve ağın işlem yükünün azaltımasını sağlamak. Bu şekilde aşırı uyma (overfitting) kontol altına alınmış olur. Pooling katmanı, bağımsız olarak çalışır ve her bir inputu <code>Max</code> operasyonu kullanarak boyutlarını azaltır. En yaygın <em>Pooling</em> katmanı, filtreleri $(2 * 2)$ boyutlarında olan ve inputu hem boydan ve hem enden ikiye bölenlerdir. Her bir <code>Max</code> operasyonu input olarak $(2 * 2)$ lik bir bölüm alacak ve bu 4 sayıdan en büyüğünü gönderecektir. Özetlemek gerekirse,</p><ul><li>Pooling katmanı input olarak $W_1 * H_1 * D_1$ boyutlarını kabul eder.</li><li>İki parametreye ihtiyaç duyar<ul><li>Boyut $F$</li><li>Stride $S$</li></ul></li><li>Boyutları $W_2 * H_2 * D_2$ olan output çıkarır.<ul><li>$W_2 = (W_1 - F)/S + 1$</li><li>$H_2 = (H_! - F)/S + 1$</li><li>$D_2 = D1$</li></ul></li></ul><p><img class=lazyload src=/svg/loading.min.svg data-src=../../images/pooling.png data-srcset="../../images/pooling.png, ../../images/pooling.png 1.5x, ../../images/pooling.png 2x" data-sizes=auto alt=../../images/pooling.png title="Convolutional Sinir Ağları Pooling Layer Örneği"></p><p>Resimde de görüleceği üzere her bir $(2 * 2)$ lik bölümden en büyük sayılar alınıp yeni bir örnek elde ediliyor.</p><p>Şimdi bunu Python ile kodlamaya çalışalım.</p><h3 id=pooling-layer-python-ile-implementasyonu>Pooling Layer Python İle İmplementasyonu</h3><p>Bu layerı hem sıfırdan hem de kütüphane kullanarak kodlayabiliriz. Önce kütüphane kullanarak gösterelim.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>constant</span><span class=p>([[</span><span class=mf>1.</span><span class=p>,</span> <span class=mf>2.</span><span class=p>,</span> <span class=mf>3.</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                 <span class=p>[</span><span class=mf>4.</span><span class=p>,</span> <span class=mf>5.</span><span class=p>,</span> <span class=mf>6.</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                 <span class=p>[</span><span class=mf>7.</span><span class=p>,</span> <span class=mf>8.</span><span class=p>,</span> <span class=mf>9.</span><span class=p>]])</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>max_pool_2d</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>MaxPooling2D</span><span class=p>(</span><span class=n>pool_size</span><span class=o>=</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>),</span>
</span></span><span class=line><span class=cl>   <span class=n>strides</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span> <span class=n>padding</span><span class=o>=</span><span class=s1>&#39;valid&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>max_pool_2d</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Bu koddan çıkacak output ise</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>&lt;</span><span class=n>tf</span><span class=o>.</span><span class=n>Tensor</span><span class=p>:</span> <span class=n>shape</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=n>float32</span><span class=p>,</span> <span class=n>numpy</span><span class=o>=</span>
</span></span><span class=line><span class=cl>  <span class=n>array</span><span class=p>([[[[</span><span class=mf>5.</span><span class=p>],</span>
</span></span><span class=line><span class=cl>          <span class=p>[</span><span class=mf>6.</span><span class=p>]],</span>
</span></span><span class=line><span class=cl>          <span class=p>[[</span><span class=mf>8.</span><span class=p>],</span>
</span></span><span class=line><span class=cl>          <span class=p>[</span><span class=mf>9.</span><span class=p>]]]],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>float32</span><span class=p>)</span><span class=o>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Çıkan sonucun nasıl çıktığını bence rahatlıkla yapabilirsiniz.</p><p>Şimdi kendimiz sıfırdan bu layerı basit bir şekilde implement edelim.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>pool2d</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>pool_size</span><span class=p>,</span> <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;max&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>p_h</span><span class=p>,</span> <span class=n>p_w</span> <span class=o>=</span> <span class=n>pool_size</span>        <span class=c1>#pool size ı al</span>
</span></span><span class=line><span class=cl>    <span class=n>Y</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=n>p_h</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>p_w</span> <span class=o>+</span> <span class=mi>1</span><span class=p>))</span> <span class=c1>#Outputu oluştur</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>Y</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>Y</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>            <span class=n>Y</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>X</span><span class=p>[</span><span class=n>i</span><span class=p>:</span> <span class=n>i</span> <span class=o>+</span> <span class=n>p_h</span><span class=p>,</span> <span class=n>j</span><span class=p>:</span> <span class=n>j</span> <span class=o>+</span> <span class=n>p_w</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>   <span class=c1>#Her bir pool size kadar pixelin max&#39;ını al</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>Y</span>
</span></span></code></pre></td></tr></table></div></div><p>Şimdi kodumuzu yukarıda yazdığımız <code>x</code> arrayi ile test edersek, yine aynı sonucun çıkacağını göreceğiz.</p><p>Bu yazımızda konuşulacaklar bu kadar. Beğendiyseniz paylaşmayı unutmayın.</p><h2 id=references>REFERENCES</h2><ul><li><a href=https://anhreynolds.com/blogs/cnn.html target=_blank rel="noopener noreffer">https://anhreynolds.com/blogs/cnn.html</a></li><li><a href=https://cs231n.github.io/convolutional-networks/ target=_blank rel="noopener noreffer">https://cs231n.github.io/convolutional-networks/</a></li><li><a href=https://cezannec.github.io/Convolutional_Neural_Networks/ target=_blank rel="noopener noreffer">https://cezannec.github.io/Convolutional_Neural_Networks/</a></li><li><a href=https://www.tensorflow.org/api_docs/python/tf/keras/layers/Conv2D target=_blank rel="noopener noreffer">https://www.tensorflow.org/api_docs/python/tf/keras/layers/Conv2D</a></li><li><a href=https://www.tensorflow.org/api_docs/python/tf/keras/layers/MaxPool2D target=_blank rel="noopener noreffer">https://www.tensorflow.org/api_docs/python/tf/keras/layers/MaxPool2D</a></li><li><a href=https://medium.com/ai-in-plain-english/pooling-layer-beginner-to-intermediate-fa0dbdce80eb target=_blank rel="noopener noreffer">https://medium.com/ai-in-plain-english/pooling-layer-beginner-to-intermediate-fa0dbdce80eb</a></li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-12-07</span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/evrisimsel-sinir-aglari-nedir/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://ocakhasan.github.io/evrisimsel-sinir-aglari-nedir/ data-title="Evrişimsel Sinir Ağları  (Convolutional Neural Network) Nedir" data-hashtags=numpy,pytorch,cnn><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://ocakhasan.github.io/evrisimsel-sinir-aglari-nedir/ data-hashtag=numpy><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://ocakhasan.github.io/evrisimsel-sinir-aglari-nedir/ data-title="Evrişimsel Sinir Ağları  (Convolutional Neural Network) Nedir"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://ocakhasan.github.io/evrisimsel-sinir-aglari-nedir/ data-title="Evrişimsel Sinir Ağları  (Convolutional Neural Network) Nedir"><i data-svg-src=/lib/simple-icons/icons/line.min.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://ocakhasan.github.io/evrisimsel-sinir-aglari-nedir/ data-title="Evrişimsel Sinir Ağları  (Convolutional Neural Network) Nedir"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/numpy/>numpy</a>,&nbsp;<a href=/tags/pytorch/>pytorch</a>,&nbsp;<a href=/tags/cnn/>cnn</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/word2vec-nedir-ve-word2veckelimelerden-nasil-ogrenir/ class=prev rel=prev title="Word2Vec Nedir ve Word2Vec Kelimelerden Nasıl Öğrenir"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Word2Vec Nedir ve Word2Vec Kelimelerden Nasıl Öğrenir</a>
<a href=/pytorch-autograd-nedir-ve-nasil-calisir/ class=next rel=next title="Pytorch AutoGrad Nedir ve Nasıl Çalışır">Pytorch AutoGrad Nedir ve Nasıl Çalışır<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.108.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2019 - 2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Hasan Ocak</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/contrib/auto-render.min.js></script><script type=text/javascript src=/lib/katex/contrib/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/contrib/mhchem.min.js></script><script type=text/javascript src=/lib/cookieconsent/cookieconsent.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},cookieconsent:{content:{dismiss:"Got it!",link:"Learn more",message:"This website uses Cookies to improve your experience."},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>