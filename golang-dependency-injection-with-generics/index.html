<!doctype html><html lang=tr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Dependeny Injection In Golang - Hasan Ocak Tech Blog</title><meta name=Description content="Çeşitli konulardan bahseden bir tech blog"><meta property="og:url" content="https://ocakhasan.github.io/golang-dependency-injection-with-generics/">
<meta property="og:site_name" content="Hasan Ocak Tech Blog"><meta property="og:title" content="Dependeny Injection In Golang"><meta property="og:description" content="Let’s observe how to handle dependency injection with samber/lo package."><meta property="og:locale" content="tr"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-08-31T00:00:00+00:00"><meta property="article:modified_time" content="2024-08-31T18:54:07+03:00"><meta property="article:tag" content="Golang"><meta property="og:image" content="https://ocakhasan.github.io/logo.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://ocakhasan.github.io/logo.png"><meta name=twitter:title content="Dependeny Injection In Golang"><meta name=twitter:description content="Let’s observe how to handle dependency injection with samber/lo package."><meta name=application-name content="Hasan Ocak Tech Blog"><meta name=apple-mobile-web-app-title content="Hasan Ocak Tech Blog"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://ocakhasan.github.io/golang-dependency-injection-with-generics/><link rel=prev href=https://ocakhasan.github.io/golang-mongodb-integration-tests/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><meta name=google-site-verification content="6FsPs8qV_9zEnPMWf3bEQwRJFU2Q9imUdyZqX_99So4"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Dependeny Injection In Golang","inLanguage":"tr","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/ocakhasan.github.io\/golang-dependency-injection-with-generics\/"},"genre":"posts","keywords":"golang","wordcount":1121,"url":"https:\/\/ocakhasan.github.io\/golang-dependency-injection-with-generics\/","datePublished":"2024-08-31T00:00:00+00:00","dateModified":"2024-08-31T18:54:07+03:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Hasan Ocak"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Hasan Ocak Tech Blog">Hasan Ocak</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/about>About </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Hasan Ocak Tech Blog">Hasan Ocak</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/about title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Dependeny Injection In Golang</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Hasan Ocak</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2024-08-31>2024-08-31</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1121 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;6 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#implementation>IMPLEMENTATION</a><ul><li><a href=#straight-forward-injection>Straight Forward Injection</a></li><li><a href=#structured-injection>Structured Injection</a></li></ul></li><li><a href=#summary>Summary</a></li></ul></nav></div></div><div class=content id=content><p>Dependency injection is used to provide the necessary dependencies to the objects from external sources rather than creating the dependencies inside the objects.</p><p>For example, instead of a service creating its own dependencies, you inject those dependencies from outside, allowing you to easily swap them for different implementations or mock objects during testing.</p><p>For this blogpost we are going to use a dependency injection tool called <a href=https://github.com/samber/do target=_blank rel="noopener noreffer">samber/do</a>. Why we use this package?</p><ul><li>it is simple</li><li>it is lazily loaded.</li></ul><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw" aria-hidden=true></i>Note<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>All of the code here can be accessed from <a href=https://github.com/ocakhasan/dependency_injection_golang target=_blank rel="noopener noreffer">ocakhasan/dependency_injection_golang</a></div></div></div><h2 id=implementation>IMPLEMENTATION</h2><p>We are going to explore the package by creating a simple service. Now image that we have a service which processes the orders for the website. This service depends on 2 other services called <code>PaymentProcessor</code> and <code>NotificationService</code>.</p><p>Let&rsquo;s follow the best practices and define the interfaces for our dependencies.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>PaymentProcessor</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>ProcessPayment</span><span class=p>(</span><span class=nx>amount</span> <span class=kt>float64</span><span class=p>)</span> <span class=kt>error</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>NotificationService</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>SendNotification</span><span class=p>(</span><span class=nx>orderID</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Now let&rsquo;s have some basic implementations for our services.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;github.com/rs/zerolog&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>EmailNotification</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>logger</span> <span class=nx>zerolog</span><span class=p>.</span><span class=nx>Logger</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>n</span> <span class=o>*</span><span class=nx>EmailNotification</span><span class=p>)</span> <span class=nf>SendNotification</span><span class=p>(</span><span class=nx>orderID</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>n</span><span class=p>.</span><span class=nx>logger</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Sending email notification for order %s&#34;</span><span class=p>,</span> <span class=nx>orderID</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>NewEmailNotification</span><span class=p>(</span><span class=nx>logger</span> <span class=nx>zerolog</span><span class=p>.</span><span class=nx>Logger</span><span class=p>)</span> <span class=o>*</span><span class=nx>EmailNotification</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=o>&amp;</span><span class=nx>EmailNotification</span><span class=p>{</span><span class=nx>logger</span><span class=p>:</span> <span class=nx>logger</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;github.com/rs/zerolog&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>StripeProcessor</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>logger</span> <span class=nx>zerolog</span><span class=p>.</span><span class=nx>Logger</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=o>*</span><span class=nx>StripeProcessor</span><span class=p>)</span> <span class=nf>ProcessPayment</span><span class=p>(</span><span class=nx>amount</span> <span class=kt>float64</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>p</span><span class=p>.</span><span class=nx>logger</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Processing payment of $%.2f through Stripe&#34;</span><span class=p>,</span> <span class=nx>amount</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>NewStripeProcessor</span><span class=p>(</span><span class=nx>logger</span> <span class=nx>zerolog</span><span class=p>.</span><span class=nx>Logger</span><span class=p>)</span> <span class=o>*</span><span class=nx>StripeProcessor</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=o>&amp;</span><span class=nx>StripeProcessor</span><span class=p>{</span><span class=nx>logger</span><span class=p>:</span> <span class=nx>logger</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>As we can see</p><ul><li>the <code>StripeProcessor</code> implements the <code>PaymentProcessor</code> inferface.</li><li>the <code>EmailNotification</code> implements the <code>NotificationService</code> interface.</li></ul><p>Now let&rsquo;s create the order service with best practises</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>OrderService</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>paymentProcessor</span>  <span class=nx>PaymentProcessor</span>
</span></span><span class=line><span class=cl>    <span class=nx>notificationService</span> <span class=nx>NotificationService</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>NewOrderService</span><span class=p>(</span><span class=nx>paymentProcessor</span> <span class=nx>PaymentProcessor</span><span class=p>,</span> <span class=nx>notificationService</span> <span class=nx>NotificationService</span><span class=p>)</span> <span class=o>*</span><span class=nx>OrderService</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>&amp;</span><span class=nx>OrderService</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>paymentProcessor</span><span class=p>:</span>  <span class=nx>paymentProcessor</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>notificationService</span><span class=p>:</span> <span class=nx>notificationService</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>s</span> <span class=o>*</span><span class=nx>OrderService</span><span class=p>)</span> <span class=nf>ProcessOrder</span><span class=p>(</span><span class=nx>orderID</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>amount</span> <span class=kt>float64</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>err</span> <span class=o>:=</span> <span class=nx>s</span><span class=p>.</span><span class=nx>paymentProcessor</span><span class=p>.</span><span class=nf>ProcessPayment</span><span class=p>(</span><span class=nx>amount</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>s</span><span class=p>.</span><span class=nx>notificationService</span><span class=p>.</span><span class=nf>SendNotification</span><span class=p>(</span><span class=nx>orderID</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>We have the simple implementation ready. Let&rsquo;s do the dependency injection without and with <code>samber/do</code> package.</p><h3 id=straight-forward-injection>Straight Forward Injection</h3><p>It is pretty straightforward, you just need to initiaze the necessary dependency by yourself to provide the services by you.</p><p>Now for the small cases, such as this seems fine, but as we can see it lacks some kind of generalization, structure.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/rs/zerolog&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>logger</span> <span class=o>:=</span> <span class=nx>zerolog</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stdout</span><span class=p>).</span><span class=nf>Level</span><span class=p>(</span><span class=nx>zerolog</span><span class=p>.</span><span class=nx>DebugLevel</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>stripeProcessor</span> <span class=o>:=</span> <span class=nf>NewStripeProcessor</span><span class=p>(</span><span class=nx>logger</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>emailNotif</span> <span class=o>:=</span> <span class=nf>NewEmailNotification</span><span class=p>(</span><span class=nx>logger</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>orderService</span> <span class=o>:=</span> <span class=nf>NewOrderService</span><span class=p>(</span><span class=nx>stripeProcessor</span><span class=p>,</span> <span class=nx>emailNotif</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// Use the service
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>err</span> <span class=o>:=</span> <span class=nx>orderService</span><span class=p>.</span><span class=nf>ProcessOrder</span><span class=p>(</span><span class=s>&#34;12345&#34;</span><span class=p>,</span> <span class=mf>100.00</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nb>panic</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=structured-injection>Structured Injection</h3><p>It seems a little bit complicated but I am going to explain bit by bit.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;os&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/rs/zerolog&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/samber/do&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>injector</span> <span class=o>:=</span> <span class=nx>do</span><span class=p>.</span><span class=nf>New</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>do</span><span class=p>.</span><span class=nf>Provide</span><span class=p>(</span><span class=nx>injector</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span> <span class=o>*</span><span class=nx>do</span><span class=p>.</span><span class=nx>Injector</span><span class=p>)</span> <span class=p>(</span><span class=nx>zerolog</span><span class=p>.</span><span class=nx>Logger</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nx>zerolog</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stdout</span><span class=p>).</span><span class=nf>Level</span><span class=p>(</span><span class=nx>zerolog</span><span class=p>.</span><span class=nx>DebugLevel</span><span class=p>),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>	<span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// Bind implementations to the interfaces
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>do</span><span class=p>.</span><span class=nf>Provide</span><span class=p>(</span><span class=nx>injector</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span> <span class=o>*</span><span class=nx>do</span><span class=p>.</span><span class=nx>Injector</span><span class=p>)</span> <span class=p>(</span><span class=nx>PaymentProcessor</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>logger</span> <span class=o>:=</span> <span class=nx>do</span><span class=p>.</span><span class=nx>MustInvoke</span><span class=p>[</span><span class=nx>zerolog</span><span class=p>.</span><span class=nx>Logger</span><span class=p>](</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nf>NewStripeProcessor</span><span class=p>(</span><span class=nx>logger</span><span class=p>),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>	<span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// Bind implementations to the interfaces
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>do</span><span class=p>.</span><span class=nf>Provide</span><span class=p>(</span><span class=nx>injector</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span> <span class=o>*</span><span class=nx>do</span><span class=p>.</span><span class=nx>Injector</span><span class=p>)</span> <span class=p>(</span><span class=nx>NotificationService</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>logger</span> <span class=o>:=</span> <span class=nx>do</span><span class=p>.</span><span class=nx>MustInvoke</span><span class=p>[</span><span class=nx>zerolog</span><span class=p>.</span><span class=nx>Logger</span><span class=p>](</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nf>NewEmailNotification</span><span class=p>(</span><span class=nx>logger</span><span class=p>),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>	<span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>do</span><span class=p>.</span><span class=nf>Provide</span><span class=p>(</span><span class=nx>injector</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span> <span class=o>*</span><span class=nx>do</span><span class=p>.</span><span class=nx>Injector</span><span class=p>)</span> <span class=p>(</span><span class=o>*</span><span class=nx>OrderService</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>paymentProcessor</span> <span class=o>:=</span> <span class=nx>do</span><span class=p>.</span><span class=nx>MustInvoke</span><span class=p>[</span><span class=nx>PaymentProcessor</span><span class=p>](</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>notificationService</span> <span class=o>:=</span> <span class=nx>do</span><span class=p>.</span><span class=nx>MustInvoke</span><span class=p>[</span><span class=nx>NotificationService</span><span class=p>](</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nf>NewOrderService</span><span class=p>(</span><span class=nx>paymentProcessor</span><span class=p>,</span> <span class=nx>notificationService</span><span class=p>),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>	<span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// Resolve the OrderService and use it
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>orderService</span> <span class=o>:=</span> <span class=nx>do</span><span class=p>.</span><span class=nx>MustInvoke</span><span class=p>[</span><span class=o>*</span><span class=nx>OrderService</span><span class=p>](</span><span class=nx>injector</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>err</span> <span class=o>:=</span> <span class=nx>orderService</span><span class=p>.</span><span class=nf>ProcessOrder</span><span class=p>(</span><span class=s>&#34;12345&#34;</span><span class=p>,</span> <span class=mf>100.00</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nb>panic</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>With this package, to use something, first you need to provide it. There are multiple way to provide something,</p><ul><li><a href=https://pkg.go.dev/github.com/samber/do@v1.6.0#Provide target=_blank rel="noopener noreffer">Provide</a>: It is provided anonymously, and it is loaded lazily. You can see the example, we provided the type we want to inject.</li><li><a href=https://pkg.go.dev/github.com/samber/do@v1.6.0#Provide target=_blank rel="noopener noreffer">ProvideNamed</a>: This is same as the Provide but we define a tag to identify the object we want to provide. It is mostly useful for the case where you need to provide multiple different instances of the same type (such as multiple different loggers). To define them, a tag is needed. For example</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>injector</span> <span class=o>:=</span> <span class=nx>do</span><span class=p>.</span><span class=nf>New</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>do</span><span class=p>.</span><span class=nf>ProvideNamed</span><span class=p>(</span><span class=nx>injector</span><span class=p>,</span> <span class=s>&#34;debugLogger&#34;</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span> <span class=o>*</span><span class=nx>do</span><span class=p>.</span><span class=nx>Injector</span><span class=p>)</span> <span class=p>(</span><span class=nx>zerolog</span><span class=p>.</span><span class=nx>Logger</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>zerolog</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stdout</span><span class=p>).</span><span class=nf>Level</span><span class=p>(</span><span class=nx>zerolog</span><span class=p>.</span><span class=nx>DebugLevel</span><span class=p>),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>do</span><span class=p>.</span><span class=nf>ProvideNamed</span><span class=p>(</span><span class=nx>injector</span><span class=p>,</span> <span class=s>&#34;errorLogger&#34;</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span> <span class=o>*</span><span class=nx>do</span><span class=p>.</span><span class=nx>Injector</span><span class=p>)</span> <span class=p>(</span><span class=nx>zerolog</span><span class=p>.</span><span class=nx>Logger</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>zerolog</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stdout</span><span class=p>).</span><span class=nf>Level</span><span class=p>(</span><span class=nx>zerolog</span><span class=p>.</span><span class=nx>ErrorLevel</span><span class=p>),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// To get them use do.MustInvokeNamed
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>debugLogger</span> <span class=o>:=</span> <span class=nx>do</span><span class=p>.</span><span class=nx>MustInvokeNamed</span><span class=p>[</span><span class=nx>zerolog</span><span class=p>.</span><span class=nx>Logger</span><span class=p>](</span><span class=nx>injector</span><span class=p>,</span> <span class=s>&#34;debugLogger&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>errorLogger</span> <span class=o>:=</span> <span class=nx>do</span><span class=p>.</span><span class=nx>MustInvokeNamed</span><span class=p>[</span><span class=nx>zerolog</span><span class=p>.</span><span class=nx>Logger</span><span class=p>](</span><span class=nx>injector</span><span class=p>,</span> <span class=s>&#34;errorLogger&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>These 2 function are loaded lazily which means that if we provided something but we did not call invoke on them, these instances are not created. It is one of the most benefical features of <code>samber/do</code> package.</p><p>With this package, to access something we provided, we need to invoke them. You can check the examples from code.</p><p>With this approach you can even have a helper function, which returns the injector and you can access each of the objects inside.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;os&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/rs/zerolog&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/samber/do&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Injector</span><span class=p>()</span> <span class=o>*</span><span class=nx>do</span><span class=p>.</span><span class=nx>Injector</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>injector</span> <span class=o>:=</span> <span class=nx>do</span><span class=p>.</span><span class=nf>New</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>do</span><span class=p>.</span><span class=nf>Provide</span><span class=p>(</span><span class=nx>injector</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span> <span class=o>*</span><span class=nx>do</span><span class=p>.</span><span class=nx>Injector</span><span class=p>)</span> <span class=p>(</span><span class=nx>zerolog</span><span class=p>.</span><span class=nx>Logger</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nx>zerolog</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stdout</span><span class=p>).</span><span class=nf>Level</span><span class=p>(</span><span class=nx>zerolog</span><span class=p>.</span><span class=nx>DebugLevel</span><span class=p>),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>	<span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// Bind implementations to the interfaces
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>do</span><span class=p>.</span><span class=nf>Provide</span><span class=p>(</span><span class=nx>injector</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span> <span class=o>*</span><span class=nx>do</span><span class=p>.</span><span class=nx>Injector</span><span class=p>)</span> <span class=p>(</span><span class=nx>PaymentProcessor</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>logger</span> <span class=o>:=</span> <span class=nx>do</span><span class=p>.</span><span class=nx>MustInvoke</span><span class=p>[</span><span class=nx>zerolog</span><span class=p>.</span><span class=nx>Logger</span><span class=p>](</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nf>NewStripeProcessor</span><span class=p>(</span><span class=nx>logger</span><span class=p>),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>	<span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// Bind implementations to the interfaces
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>do</span><span class=p>.</span><span class=nf>Provide</span><span class=p>(</span><span class=nx>injector</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span> <span class=o>*</span><span class=nx>do</span><span class=p>.</span><span class=nx>Injector</span><span class=p>)</span> <span class=p>(</span><span class=nx>NotificationService</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>logger</span> <span class=o>:=</span> <span class=nx>do</span><span class=p>.</span><span class=nx>MustInvoke</span><span class=p>[</span><span class=nx>zerolog</span><span class=p>.</span><span class=nx>Logger</span><span class=p>](</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nf>NewEmailNotification</span><span class=p>(</span><span class=nx>logger</span><span class=p>),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>	<span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>do</span><span class=p>.</span><span class=nf>Provide</span><span class=p>(</span><span class=nx>injector</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span> <span class=o>*</span><span class=nx>do</span><span class=p>.</span><span class=nx>Injector</span><span class=p>)</span> <span class=p>(</span><span class=o>*</span><span class=nx>OrderService</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>paymentProcessor</span> <span class=o>:=</span> <span class=nx>do</span><span class=p>.</span><span class=nx>MustInvoke</span><span class=p>[</span><span class=nx>PaymentProcessor</span><span class=p>](</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>notificationService</span> <span class=o>:=</span> <span class=nx>do</span><span class=p>.</span><span class=nx>MustInvoke</span><span class=p>[</span><span class=nx>NotificationService</span><span class=p>](</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nf>NewOrderService</span><span class=p>(</span><span class=nx>paymentProcessor</span><span class=p>,</span> <span class=nx>notificationService</span><span class=p>),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>	<span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>injector</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Now our main function just becomes</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/samber/do&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>injector</span> <span class=o>:=</span> <span class=nf>Injector</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// Resolve the OrderService and use it
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>orderService</span> <span class=o>:=</span> <span class=nx>do</span><span class=p>.</span><span class=nx>MustInvoke</span><span class=p>[</span><span class=o>*</span><span class=nx>OrderService</span><span class=p>](</span><span class=nx>injector</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>err</span> <span class=o>:=</span> <span class=nx>orderService</span><span class=p>.</span><span class=nf>ProcessOrder</span><span class=p>(</span><span class=s>&#34;12345&#34;</span><span class=p>,</span> <span class=mf>100.00</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nb>panic</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>As we can see we cleaned up most of the stuff from main function which is the ideal case.</p><h2 id=summary>Summary</h2><p>with the samber/do package</p><ul><li>all the dependency bindings are centralized.</li><li>lazy initialization is used.</li><li>automatically handle the resolution of dependencies in correct order.</li><li>scalability is easier. As your project grows, adding new dependencies are easy.</li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2024-08-31</span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/golang-dependency-injection-with-generics/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://ocakhasan.github.io/golang-dependency-injection-with-generics/ data-title="Dependeny Injection In Golang" data-hashtags=golang><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://ocakhasan.github.io/golang-dependency-injection-with-generics/ data-hashtag=golang><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://ocakhasan.github.io/golang-dependency-injection-with-generics/ data-title="Dependeny Injection In Golang"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://ocakhasan.github.io/golang-dependency-injection-with-generics/ data-title="Dependeny Injection In Golang"><i data-svg-src=/lib/simple-icons/icons/line.min.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://ocakhasan.github.io/golang-dependency-injection-with-generics/ data-title="Dependeny Injection In Golang"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/golang/>Golang</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/golang-mongodb-integration-tests/ class=prev rel=prev title="Write Integration Tests For Mongo With Golang"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Write Integration Tests For Mongo With Golang</a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.133.1">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2019 - 2024</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Hasan Ocak</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7640992832973593" crossorigin=anonymous></script><link rel=stylesheet href=/lib/katex/katex.min.css><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/contrib/auto-render.min.js></script><script type=text/javascript src=/lib/katex/contrib/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:100},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-165674239-4",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-165674239-4" async></script></body></html>