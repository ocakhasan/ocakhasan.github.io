<!doctype html><html lang=tr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>AWS SQS SDK & Golang Complete Cheat Sheet - Hasan Ocak Tech Blog</title><meta name=Description content="Çeşitli konulardan bahseden bir tech blog"><meta property="og:title" content="AWS SQS SDK & Golang Complete Cheat Sheet"><meta property="og:description" content="Let&rsquo;s see how we can utilize AWS SQS with Golang."><meta property="og:type" content="article"><meta property="og:url" content="https://ocakhasan.github.io/aws-sqs-golang-function-examples/"><meta property="og:image" content="https://ocakhasan.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-10-18T00:00:00+00:00"><meta property="article:modified_time" content="2023-10-29T23:00:15+03:00"><meta property="og:site_name" content="Hasan Ocak Tech Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://ocakhasan.github.io/logo.png"><meta name=twitter:title content="AWS SQS SDK & Golang Complete Cheat Sheet"><meta name=twitter:description content="Let&rsquo;s see how we can utilize AWS SQS with Golang."><meta name=application-name content="Hasan Ocak Tech Blog"><meta name=apple-mobile-web-app-title content="Hasan Ocak Tech Blog"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://ocakhasan.github.io/aws-sqs-golang-function-examples/><link rel=prev href=https://ocakhasan.github.io/analysis-of-chess-games/><link rel=next href=https://ocakhasan.github.io/expectations/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><meta name=google-site-verification content="6FsPs8qV_9zEnPMWf3bEQwRJFU2Q9imUdyZqX_99So4"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"AWS SQS SDK \u0026 Golang Complete Cheat Sheet","inLanguage":"tr","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/ocakhasan.github.io\/aws-sqs-golang-function-examples\/"},"genre":"posts","keywords":"golang, sqs, aws","wordcount":1164,"url":"https:\/\/ocakhasan.github.io\/aws-sqs-golang-function-examples\/","datePublished":"2023-10-18T00:00:00+00:00","dateModified":"2023-10-29T23:00:15+03:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Hasan Ocak"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Hasan Ocak Tech Blog">Hasan Ocak</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/about>About </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Hasan Ocak Tech Blog">Hasan Ocak</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/about title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">AWS SQS SDK & Golang Complete Cheat Sheet</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Hasan Ocak</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2023-10-18>2023-10-18</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1164 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;6 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#setup>Setup</a></li><li><a href=#create-queue>Create Queue</a></li><li><a href=#fetch-queue-url>Fetch Queue URL</a></li><li><a href=#delete-queue>Delete Queue</a></li><li><a href=#list-queues>List Queues</a></li><li><a href=#send-message>Send Message</a></li><li><a href=#receive-message>Receive Message</a><ul><li><a href=#how-to-decode-the-message-into-your-struct>How to Decode the Message Into Your Struct</a></li></ul></li><li><a href=#delete-message>Delete Message</a></li><li><a href=#purge-queue>Purge Queue</a></li><li><a href=#motivation>Motivation</a></li></ul></nav></div></div><div class=content id=content><h1 id=sqs-simple-queue-service-query-examples>SQS (Simple Queue Service) Query Examples</h1><p>This page should help you to understand how to use AWS SQS with golang using the official <a href=https://pkg.go.dev/github.com/aws/aws-sdk-go-v2/service/sqs target=_blank rel="noopener noreffer">aws-sdk-go-v2/service/sqs</a>.</p><p>We will start with some basics like how to create the client to rather more complex operations such as Sending Message etc.</p><h2 id=setup>Setup</h2><p>Connecting Go application to SQS Client is quite easy. You just need to load your config and create the client.</p><p>You need to get the below packages</p><ol><li>go get -u <code>github.com/aws/aws-sdk-go-v2/config</code></li><li>go get -u <code>github.com/aws/aws-sdk-go-v2/service/sqs</code></li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/config&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/service/sqs&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>cfg</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>config</span><span class=p>.</span><span class=nf>LoadDefaultConfig</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>TODO</span><span class=p>())</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nb>panic</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>sqsClient</span> <span class=o>:=</span> <span class=nx>sqs</span><span class=p>.</span><span class=nf>NewFromConfig</span><span class=p>(</span><span class=nx>cfg</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><h2 id=create-queue>Create Queue</h2><p>AS we know, the messages are stored in the queues, so without a queue we will not be able to operate any function. Creating queues from AWS CLI is quite easy, it is also easy with AWS SDK. Let&rsquo;s create a queue with the name <code>test_queue</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;log&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/aws&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/config&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/service/sqs&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>cfg</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>config</span><span class=p>.</span><span class=nf>LoadDefaultConfig</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>TODO</span><span class=p>())</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nb>panic</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>sqsClient</span> <span class=o>:=</span> <span class=nx>sqs</span><span class=p>.</span><span class=nf>NewFromConfig</span><span class=p>(</span><span class=nx>cfg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>queue</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>sqsClient</span><span class=p>.</span><span class=nf>CreateQueue</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>TODO</span><span class=p>(),</span> <span class=o>&amp;</span><span class=nx>sqs</span><span class=p>.</span><span class=nx>CreateQueueInput</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>QueueName</span><span class=p>:</span>  <span class=nx>aws</span><span class=p>.</span><span class=nf>String</span><span class=p>(</span><span class=s>&#34;test_queue&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>		<span class=nx>Attributes</span><span class=p>:</span> <span class=kc>nil</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>Tags</span><span class=p>:</span>       <span class=kc>nil</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=p>})</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nb>panic</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>log</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;the queue url is %v&#34;</span><span class=p>,</span> <span class=o>*</span><span class=nx>queue</span><span class=p>.</span><span class=nx>QueueUrl</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>Now we have a queue with the name <code>test_queue</code>.</p><h2 id=fetch-queue-url>Fetch Queue URL</h2><p>Some operations such as sending message to a queue or deleting the queue needs the queue url as input. Even though we know the name of the queue, we still need to fetch the URL of it. It is quite easy.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;log&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/aws&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/config&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/service/sqs&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>cfg</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>config</span><span class=p>.</span><span class=nf>LoadDefaultConfig</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>TODO</span><span class=p>())</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nb>panic</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>sqsClient</span> <span class=o>:=</span> <span class=nx>sqs</span><span class=p>.</span><span class=nf>NewFromConfig</span><span class=p>(</span><span class=nx>cfg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>queue</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>sqsClient</span><span class=p>.</span><span class=nf>GetQueueUrl</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>TODO</span><span class=p>(),</span> <span class=o>&amp;</span><span class=nx>sqs</span><span class=p>.</span><span class=nx>GetQueueUrlInput</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>QueueName</span><span class=p>:</span>              <span class=nx>aws</span><span class=p>.</span><span class=nf>String</span><span class=p>(</span><span class=s>&#34;test_queue&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>		<span class=nx>QueueOwnerAWSAccountId</span><span class=p>:</span> <span class=kc>nil</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=p>})</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nb>panic</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>log</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;the queue url is %v&#34;</span><span class=p>,</span> <span class=o>*</span><span class=nx>queue</span><span class=p>.</span><span class=nx>QueueUrl</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><h2 id=delete-queue>Delete Queue</h2><p>Deleting the queue is also quite easy. You just need to call the <code>DeleteQueue</code> function. You will be using this a lot if you create temporary queues and need to delete them after a while.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/aws&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/config&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/service/sqs&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>cfg</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>config</span><span class=p>.</span><span class=nf>LoadDefaultConfig</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>TODO</span><span class=p>())</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nb>panic</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>sqsClient</span> <span class=o>:=</span> <span class=nx>sqs</span><span class=p>.</span><span class=nf>NewFromConfig</span><span class=p>(</span><span class=nx>cfg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>queue</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>sqsClient</span><span class=p>.</span><span class=nf>GetQueueUrl</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>TODO</span><span class=p>(),</span> <span class=o>&amp;</span><span class=nx>sqs</span><span class=p>.</span><span class=nx>GetQueueUrlInput</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>QueueName</span><span class=p>:</span>              <span class=nx>aws</span><span class=p>.</span><span class=nf>String</span><span class=p>(</span><span class=s>&#34;test_queue&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>		<span class=nx>QueueOwnerAWSAccountId</span><span class=p>:</span> <span class=kc>nil</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=p>})</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nb>panic</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>_</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>sqsClient</span><span class=p>.</span><span class=nf>DeleteQueue</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>TODO</span><span class=p>(),</span> <span class=o>&amp;</span><span class=nx>sqs</span><span class=p>.</span><span class=nx>DeleteQueueInput</span><span class=p>{</span><span class=nx>QueueUrl</span><span class=p>:</span> <span class=nx>queue</span><span class=p>.</span><span class=nx>QueueUrl</span><span class=p>})</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nb>panic</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><h2 id=list-queues>List Queues</h2><p>Sometimes we need to list the queues to see which queues there are in the AWS. You can even set a prefix to get the queues with wanted prefix.</p><p>Let&rsquo;s fetch the queues with prefix <code>test</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;log&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/aws&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/config&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/service/sqs&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>cfg</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>config</span><span class=p>.</span><span class=nf>LoadDefaultConfig</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>TODO</span><span class=p>())</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nb>panic</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>sqsClient</span> <span class=o>:=</span> <span class=nx>sqs</span><span class=p>.</span><span class=nf>NewFromConfig</span><span class=p>(</span><span class=nx>cfg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>queues</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>sqsClient</span><span class=p>.</span><span class=nf>ListQueues</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>TODO</span><span class=p>(),</span> <span class=o>&amp;</span><span class=nx>sqs</span><span class=p>.</span><span class=nx>ListQueuesInput</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>MaxResults</span><span class=p>:</span>      <span class=kc>nil</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>NextToken</span><span class=p>:</span>       <span class=kc>nil</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>QueueNamePrefix</span><span class=p>:</span> <span class=nx>aws</span><span class=p>.</span><span class=nf>String</span><span class=p>(</span><span class=s>&#34;test&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>	<span class=p>})</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nb>panic</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>queueUrl</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>queues</span><span class=p>.</span><span class=nx>QueueUrls</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>log</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>queueUrl</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><h2 id=send-message>Send Message</h2><p>The most important part of the queues is mostly is receiving & sending messages part. The whole point of the queue is to become the middle man which has the responsibility of taking and delivering the messages. Sending a message in SQS quite easy.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;encoding/json&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;log&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/aws&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/config&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/service/sqs&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>YourStruct</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Artist</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>	<span class=nx>Song</span>   <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>cfg</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>config</span><span class=p>.</span><span class=nf>LoadDefaultConfig</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>TODO</span><span class=p>())</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nb>panic</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>sqsClient</span> <span class=o>:=</span> <span class=nx>sqs</span><span class=p>.</span><span class=nf>NewFromConfig</span><span class=p>(</span><span class=nx>cfg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>data</span> <span class=o>:=</span> <span class=nx>YourStruct</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>Artist</span><span class=p>:</span> <span class=s>&#34;Queen&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>Song</span><span class=p>:</span> <span class=s>&#34;The Show Must Go On&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>bytes</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>json</span><span class=p>.</span><span class=nf>Marshal</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>queue</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>sqsClient</span><span class=p>.</span><span class=nf>GetQueueUrl</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>TODO</span><span class=p>(),</span> <span class=o>&amp;</span><span class=nx>sqs</span><span class=p>.</span><span class=nx>GetQueueUrlInput</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>QueueName</span><span class=p>:</span> <span class=nx>aws</span><span class=p>.</span><span class=nf>String</span><span class=p>(</span><span class=s>&#34;test_queue&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>	<span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>res</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>sqsClient</span><span class=p>.</span><span class=nf>SendMessage</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>TODO</span><span class=p>(),</span> <span class=o>&amp;</span><span class=nx>sqs</span><span class=p>.</span><span class=nx>SendMessageInput</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>MessageBody</span><span class=p>:</span>             <span class=nx>aws</span><span class=p>.</span><span class=nf>String</span><span class=p>(</span><span class=nb>string</span><span class=p>(</span><span class=nx>bytes</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>		<span class=nx>QueueUrl</span><span class=p>:</span>                <span class=nx>queue</span><span class=p>.</span><span class=nx>QueueUrl</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>DelaySeconds</span><span class=p>:</span>            <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>MessageAttributes</span><span class=p>:</span>       <span class=kc>nil</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>MessageDeduplicationId</span><span class=p>:</span>  <span class=kc>nil</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>MessageGroupId</span><span class=p>:</span>          <span class=kc>nil</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>MessageSystemAttributes</span><span class=p>:</span> <span class=kc>nil</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=p>})</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nb>panic</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>log</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;the message with id %v is sent&#34;</span><span class=p>,</span> <span class=o>*</span><span class=nx>res</span><span class=p>.</span><span class=nx>MessageId</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><h2 id=receive-message>Receive Message</h2><p>The other most important part of the queues are receiving the message, because as we know the messages are only sent for someone to read it. I think that could be a good quote so let&rsquo;s make a one.</p><div class="details admonition quote open"><div class="details-summary admonition-title"><i class="icon fas fa-quote-right fa-fw" aria-hidden=true></i>Hasan Ocak<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>Messages are only sent for someone to read it.</div></div></div><p>Handling messages in SQS can be quite complex. If you want to learn how to receive message and handle them in parallel, check out my other post <a href=https://ocakhasan.github.io/golang-sqs-consumer-worker-pool/ target=_blank rel="noopener noreffer">Golang Sqs Consumer Worker Pool</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;log&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/aws&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/config&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/service/sqs&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>cfg</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>config</span><span class=p>.</span><span class=nf>LoadDefaultConfig</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>TODO</span><span class=p>())</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nb>panic</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>sqsClient</span> <span class=o>:=</span> <span class=nx>sqs</span><span class=p>.</span><span class=nf>NewFromConfig</span><span class=p>(</span><span class=nx>cfg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>queue</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>sqsClient</span><span class=p>.</span><span class=nf>GetQueueUrl</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>TODO</span><span class=p>(),</span> <span class=o>&amp;</span><span class=nx>sqs</span><span class=p>.</span><span class=nx>GetQueueUrlInput</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>QueueName</span><span class=p>:</span> <span class=nx>aws</span><span class=p>.</span><span class=nf>String</span><span class=p>(</span><span class=s>&#34;test_queue&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>	<span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>messages</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>sqsClient</span><span class=p>.</span><span class=nf>ReceiveMessage</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>TODO</span><span class=p>(),</span> <span class=o>&amp;</span><span class=nx>sqs</span><span class=p>.</span><span class=nx>ReceiveMessageInput</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>QueueUrl</span><span class=p>:</span>                <span class=nx>queue</span><span class=p>.</span><span class=nx>QueueUrl</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>AttributeNames</span><span class=p>:</span>          <span class=kc>nil</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>MaxNumberOfMessages</span><span class=p>:</span>     <span class=mi>10</span><span class=p>,</span> <span class=c1>// max is 10
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=nx>MessageAttributeNames</span><span class=p>:</span>   <span class=kc>nil</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>ReceiveRequestAttemptId</span><span class=p>:</span> <span class=kc>nil</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>VisibilityTimeout</span><span class=p>:</span>       <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>WaitTimeSeconds</span><span class=p>:</span>         <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=p>})</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nb>panic</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>message</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>messages</span><span class=p>.</span><span class=nx>Messages</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>log</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;the message body is %v&#34;</span><span class=p>,</span> <span class=o>*</span><span class=nx>message</span><span class=p>.</span><span class=nx>Body</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>Output will be something like this</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>2023/10/18 22:22:57 the message body is {&#34;Artist&#34;:&#34;Queen&#34;,&#34;Song&#34;:&#34;The Show Must Go On&#34;}
</span></span></code></pre></td></tr></table></div></div><h3 id=how-to-decode-the-message-into-your-struct>How to Decode the Message Into Your Struct</h3><p>You just need to decode it via <code>json.Unmarshal</code> to your struct.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>message</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>messages</span><span class=p>.</span><span class=nx>Messages</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>data</span> <span class=nx>YourStruct</span>
</span></span><span class=line><span class=cl>    <span class=nx>_</span> <span class=p>=</span> <span class=nx>json</span><span class=p>.</span><span class=nf>Unmarshal</span><span class=p>([]</span><span class=nb>byte</span><span class=p>(</span><span class=o>*</span><span class=nx>message</span><span class=p>.</span><span class=nx>Body</span><span class=p>),</span> <span class=o>&amp;</span><span class=nx>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>log</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;the received data is %+v&#34;</span><span class=p>,</span> <span class=nx>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=delete-message>Delete Message</h2><p>In general after handling the message, you will want to delete the message so it will not be received and handled again. Of course this can change according to your needs. Deleting the message is quite easy.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/aws&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/config&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/service/sqs&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>YourStruct</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>University</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>	<span class=nx>Major</span>      <span class=kt>string</span>
</span></span><span class=line><span class=cl>	<span class=nx>Level</span>      <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>cfg</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>config</span><span class=p>.</span><span class=nf>LoadDefaultConfig</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>TODO</span><span class=p>())</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nb>panic</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>sqsClient</span> <span class=o>:=</span> <span class=nx>sqs</span><span class=p>.</span><span class=nf>NewFromConfig</span><span class=p>(</span><span class=nx>cfg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>queue</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>sqsClient</span><span class=p>.</span><span class=nf>GetQueueUrl</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>TODO</span><span class=p>(),</span> <span class=o>&amp;</span><span class=nx>sqs</span><span class=p>.</span><span class=nx>GetQueueUrlInput</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>QueueName</span><span class=p>:</span> <span class=nx>aws</span><span class=p>.</span><span class=nf>String</span><span class=p>(</span><span class=s>&#34;test_queue&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>	<span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// It can be read from message variable after receiving from SQS
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>messageHandle</span> <span class=o>:=</span> <span class=s>&#34;YOUR_MESSAGE_HANDLE&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>_</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>sqsClient</span><span class=p>.</span><span class=nf>DeleteMessage</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>TODO</span><span class=p>(),</span> <span class=o>&amp;</span><span class=nx>sqs</span><span class=p>.</span><span class=nx>DeleteMessageInput</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>QueueUrl</span><span class=p>:</span>      <span class=nx>queue</span><span class=p>.</span><span class=nx>QueueUrl</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>ReceiptHandle</span><span class=p>:</span> <span class=o>&amp;</span><span class=nx>messageHandle</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=p>})</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nb>panic</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><h2 id=purge-queue>Purge Queue</h2><p>If you want to delete all of the messages in the queue, you need to use the <code>PurgeQueue</code> method.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/aws&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/config&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/aws/aws-sdk-go-v2/service/sqs&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>cfg</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>config</span><span class=p>.</span><span class=nf>LoadDefaultConfig</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>TODO</span><span class=p>())</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nb>panic</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>sqsClient</span> <span class=o>:=</span> <span class=nx>sqs</span><span class=p>.</span><span class=nf>NewFromConfig</span><span class=p>(</span><span class=nx>cfg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>queue</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>sqsClient</span><span class=p>.</span><span class=nf>GetQueueUrl</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>TODO</span><span class=p>(),</span> <span class=o>&amp;</span><span class=nx>sqs</span><span class=p>.</span><span class=nx>GetQueueUrlInput</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>QueueName</span><span class=p>:</span> <span class=nx>aws</span><span class=p>.</span><span class=nf>String</span><span class=p>(</span><span class=s>&#34;test_queue&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>	<span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>_</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>sqsClient</span><span class=p>.</span><span class=nf>PurgeQueue</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>TODO</span><span class=p>(),</span> <span class=o>&amp;</span><span class=nx>sqs</span><span class=p>.</span><span class=nx>PurgeQueueInput</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>QueueUrl</span><span class=p>:</span> <span class=nx>queue</span><span class=p>.</span><span class=nx>QueueUrl</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=p>})</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nb>panic</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><h2 id=motivation>Motivation</h2><p>This post is too basic with SQS but it might help a beginner programmer who is trying to do some stuff with SQS. While I was doing some development with <code>DynamoDB</code>, I got help from this <a href=https://dynobase.dev/dynamodb-golang-query-examples/ target=_blank rel="noopener noreffer">blog</a>. It really helped me to get the development going.</p><p>I wanted to do it the same with SQS. The reason I do it with SQS is I work with it often, so I know some stuff about it.</p><p>Hope, it will help you. If it helps or not, you can reach out to me.</p><p>Let&rsquo;s end the topic with a calming music. Enjoy 🎵 💻</p><meting-js auto="https://music.163.com/#/song?id=1322030323" theme=#448aff></meting-js></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2023-10-29</span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/aws-sqs-golang-function-examples/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://ocakhasan.github.io/aws-sqs-golang-function-examples/ data-title="AWS SQS SDK & Golang Complete Cheat Sheet" data-hashtags=golang,sqs,aws><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://ocakhasan.github.io/aws-sqs-golang-function-examples/ data-hashtag=golang><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://ocakhasan.github.io/aws-sqs-golang-function-examples/ data-title="AWS SQS SDK & Golang Complete Cheat Sheet"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://ocakhasan.github.io/aws-sqs-golang-function-examples/ data-title="AWS SQS SDK & Golang Complete Cheat Sheet"><i data-svg-src=/lib/simple-icons/icons/line.min.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://ocakhasan.github.io/aws-sqs-golang-function-examples/ data-title="AWS SQS SDK & Golang Complete Cheat Sheet"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/golang/>golang</a>,&nbsp;<a href=/tags/sqs/>sqs</a>,&nbsp;<a href=/tags/aws/>aws</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/analysis-of-chess-games/ class=prev rel=prev title="Analysis Of My Lichess Bullet Games"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Analysis Of My Lichess Bullet Games</a>
<a href=/expectations/ class=next rel=next title="(tr) beklentiler">(tr) beklentiler<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.119.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2019 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Hasan Ocak</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/aplayer/APlayer.min.css><link rel=stylesheet href=/lib/aplayer/dark.min.css><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/contrib/auto-render.min.js></script><script type=text/javascript src=/lib/katex/contrib/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/contrib/mhchem.min.js></script><script type=text/javascript src=/lib/aplayer/APlayer.min.js></script><script type=text/javascript src=/lib/meting/Meting.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:100},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-165674239-4",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-165674239-4" async></script></body></html>